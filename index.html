<script>
    document.getElementById("chooseButton").addEventListener("click", function() {
        this.style.display = "none"; // ボタンを非表示
    });

    document.querySelectorAll('.deck-card').forEach(card => {
        card.addEventListener('click', function() {
            document.getElementById("chooseButton").style.display = "none"; // 選択時に「1枚カードを選ぶ」を確実に非表示
            document.querySelectorAll('.deck-card').forEach(c => c.style.pointerEvents = "none");
            const randomFront = Object.keys(cards)[Math.floor(Math.random() * Object.keys(cards).length)];
            this.querySelector('.card-front img').src = randomFront;
            this.style.transform = "rotateY(180deg) scale(1.3)";
            this.style.left = "270px";
            this.style.top = "30px";
            this.style.zIndex = "999";

            document.querySelectorAll('.deck-card').forEach(c => {
                if (c !== this) {
                    c.style.transform = "scale(0.5)";
                    c.style.opacity = "0";
                }
            });

            setTimeout(() => {
                document.getElementById("cardMessage").textContent = cards[randomFront];
                document.getElementById("cardMessage").style.display = "block";
                document.getElementById("rechooseButton").style.display = "inline-block";
            }, 1000);
        });
    });

    function resetDeck() {
        document.getElementById("cardMessage").style.display = "none";
        document.getElementById("rechooseButton").style.display = "none";
        document.getElementById("chooseButton").style.display = "none"; // ここで確実に消す

        document.querySelectorAll('.deck-card').forEach(card => {
            card.style.transition = "all 1.5s ease";
            card.style.transform = "rotateY(0deg) scale(1)";
            card.style.opacity = "1";
            card.style.left = "";
            card.style.top = "";
            card.style.pointerEvents = "auto";
        });

        setTimeout(spreadDeck, 1500);
    }

    document.getElementById("rechooseButton").addEventListener("click", function() {
        this.style.display = "none";
        setTimeout(() => {
            resetDeck();
        }, 500);
    });
</script>
